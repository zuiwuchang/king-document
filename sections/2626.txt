var __v="\u003cpre class=\"k-pre\"\u003e//創建一個到 scm 管理器的 連接 \n//成功返回 連接句柄 \n//失敗返回 NULL\nSC_HANDLE WINAPI OpenSCManager(\n\t__in_opt  LPCTSTR lpMachineName,\t//計算機名 NULL 連接本機\n\t__in_opt  LPCTSTR lpDatabaseName,\t//應該設置爲SERVICES_ACTIVE_DATABASE 如果位NULL也會使用 SERVICES_ACTIVE_DATABASE\n\t__in      DWORD dwDesiredAccess\t//需要的權限\n);\n\n//關閉到scm的 連接\nBOOL WINAPI CloseServiceHandle(\n\t__in  SC_HANDLE hSCObject\n);\n\n//創建一個服務\nSC_HANDLE WINAPI CreateService(\n\t__in       SC_HANDLE hSCManager,\t//OpenSCManager 返回的 scm 句柄\n\t__in       LPCTSTR lpServiceName,\t//服務名稱 最大長度256\n\t__in_opt   LPCTSTR lpDisplayName,\t//服務顯示名稱 最大長度256\n\t__in       DWORD dwDesiredAccess,\t//返回的服務句柄 擁有的權限\n\t__in       DWORD dwServiceType,\t\t//服務類型 如果進程只有一個服務 SERVICE_WIN32_OWN_PROCESS 否則 SERVICE_WIN32_SHARE_PROCESS\n\t__in       DWORD dwStartType,\t\t//啓動方式 SERVICE_AUTO_START SERVICE_DEMAND_START SERVICE_DISABLED\n\t__in       DWORD dwErrorControl,\n\t__in_opt   LPCTSTR lpBinaryPathName,\t//服務提供 exe 路徑 啓動參數\n\t__in_opt   LPCTSTR lpLoadOrderGroup,\n\t__out_opt  LPDWORD lpdwTagId,\n\t__in_opt   LPCTSTR lpDependencies,\t\t//運行依賴\n\t__in_opt   LPCTSTR lpServiceStartName,\t//運行用戶名 NULL 使用 LocalSystem \n\t__in_opt   LPCTSTR lpPassword\n);\n\n//打開服務\nSC_HANDLE WINAPI OpenService(\n\t__in  SC_HANDLE hSCManager,\n\t__in  LPCTSTR lpServiceName,\n\t__in  DWORD dwDesiredAccess\n);\n\n//刪除服務\nBOOL WINAPI DeleteService(\n\t__in  SC_HANDLE hService\n);\n\u003c/pre\u003e"