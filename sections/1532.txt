var __v="\n\u003cpre class='prettyprint linenums'\u003e//原函数指针声明\nextern \"C\"\ntypedef\nNTSTATUS (__stdcall *OldNtQueryInformationProcess)(\n  __in       HANDLE ProcessHandle,\n  __in       PROCESSINFOCLASS ProcessInformationClass,\n  __out      PVOID ProcessInformation,\n  __in       ULONG ProcessInformationLength,\n  __out_opt  PULONG ReturnLength\n);\n\n\n//自定义hook函数\n\nextern \"C\"\nNTSTATUS __stdcall MyNtQueryInformationProcess(\n  __in       HANDLE ProcessHandle,\n  __in       PROCESSINFOCLASS ProcessInformationClass,\n  __out      PVOID ProcessInformation,\n  __in       ULONG ProcessInformationLength,\n  __out_opt  PULONG ReturnLength\n);\n\nVOID Hook_NtQueryInformationProcess();\nVOID Unhook_NtQueryInformationProcess();\n\u003c/pre\u003e"