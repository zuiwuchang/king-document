var __v="\n\u003cpre class='prettyprint linenums'\u003e//获取子进程句柄\nHANDLE hProcess = OpenProcess(PROCESS_QUERY_INFORMATION | PROCESS_CREATE_THREAD | PROCESS_VM_OPERATION | PROCESS_VM_WRITE, FALSE, pid/*process_information.dwProcessId*/);\nif ( !hProcess ) \n{\n\tMessageBox(L\"获取子进程句柄失败\");\n\treturn ;\n}\n\n\nint cByte  = (dll.GetLength()+1)* sizeof(wchar_t);\nLPVOID pAddr = VirtualAllocEx(hProcess, NULL, cByte, MEM_COMMIT, PAGE_READWRITE);\nif ( !pAddr || !WriteProcessMemory(hProcess, pAddr, dll.GetBuffer(), cByte, NULL)) \n{\n\tMessageBox(L\"申请或写入远程内存失败\");\n\treturn ;\n}\n\n//获取loadlibrary地址\nPTHREAD_START_ROUTINE pfnStartAddr = (PTHREAD_START_ROUTINE)GetProcAddress(GetModuleHandle(_T(\"Kernel32\")), \"LoadLibraryW\");\nif ( !pfnStartAddr ) \n{\n\tMessageBox(L\"获取LoadLibraryW地址失败\");\n\treturn ;\n}\n\nDWORD dwThreadID = 0;\n//利用远程线程 注入dll\nHANDLE hRemoteThread = CreateRemoteThread(hProcess, NULL, 0, pfnStartAddr, pAddr, 0, \u0026amp;dwThreadID);\nif ( !hRemoteThread ) \n{\n\tMessageBox(L\"注入失败\");\n\treturn ;\n\n}\nCloseHandle(hRemoteThread);\nCloseHandle(hProcess);\u003c/pre\u003e"