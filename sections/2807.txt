var __v="\n\u003cpre class='prettyprint linenums'\u003e#define WM_TP WM_USER+1102  /*定义托盘消息*/\nNOTIFYICONDATA tp;\t\t/*定义托盘对象*/\n\n/*设置托盘选项*/\nmemset(\u0026amp;tp,0,sizeof(NOTIFYICONDATA));\ntp.cbSize=sizeof(NOTIFYICONDATA);\ntp.uFlags=NIF_ICON|NIF_MESSAGE|NIF_TIP;\ntp.uCallbackMessage=WM_TP;\t/*响应消息*/\ntp.uID=1;\t\t/*唯一标识id 随意设置*/\ntp.hWnd=m_hWnd;\t\t\t/*所属窗口句柄*/\nwcscpy_s(tp.szTip,L\"IDEA\");\t/*鼠标指示时显示的文字*/\ntp.hIcon=LoadIconW(::AfxGetInstanceHandle(),MAKEINTRESOURCE(IDR_MAINFRAME)); /*托盘图标*/\n\n/*显示托盘*/\nShowWindow(SW_MINIMIZE);\nShowWindow(SW_HIDE);\nShell_NotifyIcon(NIM_ADD,\u0026amp;tp);\n\n/*删除托盘*/\nShell_NotifyIconW(NIM_DELETE,\u0026amp;tp);\nShowWindow(SW_RESTORE);\nSetForegroundWindow(); \n\n/*响应托盘消息*/\nif(WM_TP==message )\n{\n\tswitch(lParam)\n\t{\n\t\tcase WM_LBUTTONDBLCLK:\n\t\t/*Shell_NotifyIconW(NIM_DELETE,\u0026amp;tp);\n\t\tShowWindow(SW_RESTORE);\n\t\tSetForegroundWindow();*/\n\t\t... \n\t\tbreak;\n\t\tcase WM_RBUTTONDOWN:\n\t\t/*{\n\t\t\tCPoint p;\n\t\t\t::GetCursorPos(\u0026amp;p);\n\t\t\tCMenu *lp,menu;\n\t\t\tmenu.LoadMenu(IDR_MENU1);\n\t\t\tlp=menu.GetSubMenu(1);\n\t\t\tlp-\u0026gt;TrackPopupMenu(TPM_LEFTALIGN | TPM_LEFTBUTTON, p.x, p.y, this);\n\t\t}*/\n\t\t...\n\t\tbreak;\n\t}\n}\n\u003c/pre\u003e"