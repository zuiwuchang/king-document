var __v="\n\u003cpre class='prettyprint linenums'\u003eif(OpenClipboard()) /*打开剪贴板*/\n{\n\tif(EmptyClipboard())/*清空剪贴板 并使当前打开剪贴板的窗口获取剪贴板的所有权*/\n\t{\n\t\tCString wcs=L\"this is a test\";\n\t\tint len=(wcs.GetLength()+1)*sizeof(wchar_t);\n\t\t/*申请内存 并返回内存句柄(指向内存链表)  GlobalAlloc(GMEM_MOVEABLE,len) 申请内存 并返回内存句柄指向内存地址*/\n\t\tHANDLE hClip=GlobalAlloc(GMEM_MOVEABLE,len);\n\t\t/*根据指向内存链表的句柄获取内存地址*/\n\t\twchar_t * pBuf=(wchar_t *)GlobalLock(hClip);\n\t\twcscpy_s(pBuf,len/2,wcs.GetBuffer(0));\n\t\tGlobalUnlock(hClip);\n\t\t/*设置剪贴板*/\n\t\tSetClipboardData(CF_UNICODETEXT,hClip);\n\t\t/*关闭剪贴板 释放其所有权*/\n\t\tCloseClipboard();\n\t}\n}\u003c/pre\u003e"