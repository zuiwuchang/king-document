var __v="\u003cstrong\u003e*.h\u003c/strong\u003e\n\u003cpre class='prettyprint linenums'\u003eclass CPluginsDialog : public CDHtmlDialog\n{\n...\n\tBOOL JsExecute(VARIANT\u0026amp; cmd);\n\tVARIANT JsGetCmds();\n\tDECLARE_DISPATCH_MAP()\n}\u003c/pre\u003e\n\u003cstrong\u003e*.cpp\u003c/strong\u003e\n\u003cpre class='prettyprint linenums'\u003eBEGIN_DISPATCH_MAP(CPluginsDialog, CDHtmlDialog)   \n\tDISP_FUNCTION(CPluginsDialog, \"Execute\",  JsExecute, VT_BOOL, VTS_VARIANT) \n\tDISP_FUNCTION(CPluginsDialog, \"GetCmds\",  JsGetCmds, VT_VARIANT,VTS_NONE)\nEND_DISPATCH_MAP() \n\nBOOL CPluginsDialog::OnInitDialog()\n{\n\tCDHtmlDialog::OnInitDialog();\n\t...\n\t\n\tEnableAutomation();\n\tSetExternalDispatch(GetIDispatch(TRUE));\n\n\t...\n}\n\nBOOL CPluginsDialog::JsExecute(VARIANT\u0026amp; cmd)\n{\n\tCString str = cmd;\n\tif(str == L\"ok\")\n\t{\n\t\treturn TRUE;\n\t}\n\treturn FALSE;\n}\nVARIANT CPluginsDialog::JsGetCmds()\n{\n\tCString str = L\"return str test\";\n\tCComVariant rs = str;\n\treturn rs;\n}\u003c/pre\u003e"