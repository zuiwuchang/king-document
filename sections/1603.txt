var __v="\u003cpre class=\"k-pre\"\u003e資源表用於保存 程序需要用到的資源 \n\u003cstrong\u003e資源表一三層結構表示 每層包含一個 IMAGE_RESOURCE_DIRECTORY 和 IMAGE_RESOURCE_DIRECTORY_ENTRY 結構\nIMAGE_RESOURCE_DIRECTORY 用以確定其後緊跟的 IMAGE_RESOURCE_DIRECTORY_ENTRY 數目\u003c/strong\u003e\n\n typedef struct _IMAGE_RESOURCE_DIRECTORY {\n\tDWORD   Characteristics;\t\t//必須為0\n\tDWORD   TimeDateStamp;\t\t//創建時間\n\tWORD    MajorVersion;\t\t\t//資源版本號 大部分為0\n\tWORD    MinorVersion;\t\t\t//同上\n\tWORD    NumberOfNamedEntries;\t//以名稱命名資源個數\n\tWORD    NumberOfIdEntries;\t\t//以id命名資源個數\n\t//  IMAGE_RESOURCE_DIRECTORY_ENTRY DirectoryEntries[];\n} IMAGE_RESOURCE_DIRECTORY, *PIMAGE_RESOURCE_DIRECTORY;\n\ntypedef struct _IMAGE_RESOURCE_DIRECTORY_ENTRY {\n\tunion {\n\t\tstruct {\n\t\t\tDWORD NameOffset:31;\n\t\t\tDWORD NameIsString:1;\t//是否是以名稱命名\n\t\t} DUMMYSTRUCTNAME;\n\t\tDWORD   Name;\t\t//名稱相對資源表偏移 指向IMAGE_RESOURCE_DIR_STRING_U結構\n\t\tWORD    Id;\n\t} DUMMYUNIONNAME;\t\t//名稱或id\n\tunion {\n\t\tDWORD   OffsetToData;\n\t\tstruct {\n\t\t\tDWORD   OffsetToDirectory:31;\n\t\t\tDWORD   DataIsDirectory:1;\t//為1 低位指向下層目錄 否則指向最終資源塊(當第三層時)\n\t\t} DUMMYSTRUCTNAME2;\n\t} DUMMYUNIONNAME2;\t\t//指向下層資源 相對資源表偏移\n} IMAGE_RESOURCE_DIRECTORY_ENTRY, *PIMAGE_RESOURCE_DIRECTORY_ENTRY;\n\ntypedef struct _IMAGE_RESOURCE_DIR_STRING_U {\n\tWORD    Length;\t\t\t//名稱長度不包含 0 且 不以0為字符串結尾\n\tWCHAR   NameString[ 1 ];\t\t\n} IMAGE_RESOURCE_DIR_STRING_U, *PIMAGE_RESOURCE_DIR_STRING_U;\n\u003c/pre\u003e"