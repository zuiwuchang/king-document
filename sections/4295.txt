var __v="\u003cpre class=\"k-pre\"\u003eiptables 設置規則後 重啟 規則將被還原 除非執行\nservice iptables save 保存當前規則\n\u003cstrong\u003e//ubuntu 無法保存\u003c/strong\u003e\n\n亦可編輯個sh腳本 每次開機 重新設置規則\n並將腳本加入到 /etc/rc.d/rc.local 中\n\u003cstrong\u003e(ubuntu是 /etc/rc.local)\u003c/strong\u003e\n\u003c/pre\u003e\n\u003cpre class='prettyprint linenums'\u003e#!/bin/bash\n#Program:\n#      my iptables setting\n#History:\n#       2017-12-4 king first release\n#Email:\n#       zuiwuchang@gmail.com\n\n# clear all rules\niptables -t nat -F\niptables -t filter -F\niptables -t mangle -F\n\n#forword 80 to 8080\n#iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to-port 8080\n \n# allow ping lo(0.0.0.0)\niptables -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT\niptables -A INPUT -p icmp -j ACCEPT\niptables -A INPUT -i lo -j ACCEPT\n\n#allow 80 ...\niptables -A INPUT -p tcp -m tcp --dport 80 -j ACCEPT\n#sudo iptables -A INPUT -p tcp -m tcp --dport 8080 -j ACCEPT\n#sudo iptables -A INPUT -p tcp -m tcp --dport 3306 -j ACCEPT\n\n#allow ssh\niptables -A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT\n\n#reject all other\niptables -A INPUT -j REJECT --reject-with icmp-host-prohibited\niptables -A FORWARD -j REJECT --reject-with icmp-host-prohibited\n\u003c/pre\u003e"