var __v="\n\u003cpre class='prettyprint linenums'\u003eHKEY hKey_exe=NULL,hKey_dll=NULL;\nDWORD dwDisposition;\n\nif(ERROR_SUCCESS!=RegCreateKeyEx(HKEY_CLASSES_ROOT ,L\"exefile\\\\shell\",0,NULL,REG_OPTION_VOLATILE,KEY_ALL_ACCESS,NULL,\u0026amp;hKey_exe,\u0026amp;dwDisposition)\n\t|| ERROR_SUCCESS!=RegCreateKeyEx(HKEY_CLASSES_ROOT ,L\"dllfile\\\\shell\",0,NULL,REG_OPTION_VOLATILE,KEY_ALL_ACCESS,NULL,\u0026amp;hKey_dll,\u0026amp;dwDisposition)\n\t)\n{\n\tif(hKey_exe)\n\t{\n\t\tRegCloseKey(hKey_exe);\n\t}\n\tif(hKey_dll)\n\t{\n\t\tRegCloseKey(hKey_dll);\n\t}\n\tMessageBox(L\"无法添加关联 创建注册表信息失败\");\n\treturn;\n}\n\nRegDeleteKey(hKey_exe,L\"Scan with WinPe\\\\command\");\nRegDeleteKey(hKey_exe,L\"Scan with WinPe\");\n\nRegDeleteKey(hKey_dll,L\"Scan with WinPe\\\\command\");\nRegDeleteKey(hKey_dll,L\"Scan with WinPe\");\n\nRegCloseKey(hKey_exe);\nRegCloseKey(hKey_dll);\u003c/pre\u003e"