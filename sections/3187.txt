var __v="\n\u003cpre class='prettyprint linenums'\u003etry\n{\n\tLPDIRECTSOUND8  device;\n\tif(DS_OK != DirectSoundCreate8(\n\t\tNULL\t\t\t\t\t//設備對象GUI NULL使用系統默認設備\n\t\t,\u0026amp;device\t\t//返回LPDIRECTSOUND8接口\n\t\t,NULL\t\t\t\t\t//系統保留 NULL\n\t\t))\n\t{\n\t\tthrow dark::debug::wexception(L\"創建設備對象失敗\");\n\t}\n\n\t//設置協作級別\n\tif(DS_OK != device-\u0026gt;SetCooperativeLevel(m_hWnd,DSSCL_PRIORITY))\n\t{\n\t\tthrow dark::debug::wexception(L\"設置協調級別失敗\");\n\t}\n\t/*返回聲音設備的屬性\n\tDSCAPS dscaps;\n\tdscaps.dwSize=sizeof(DSCAPS);\n\tdevice-\u0026gt;GetCaps(\u0026amp;dscaps);\n\t*/\n}\ncatch(const dark::debug::wexception\u0026amp; e)\n{\n\tMessageBox(e.what().c_str());\n\tEndDialog(FALSE);\n}\u003c/pre\u003e"