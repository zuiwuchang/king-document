var __v="\u003cpre class=\"prettyprint linenums\"\u003e$(document).ready(function() {\n\tvar async = Async.New();\n\tasync.Sync(function(async){\n\t\t//do something\n\t\tvar ctx = {};\n\t\tctx.sum = 0;\n\n\t\t//async call\n\t\tsetTimeout(function(){\n\t\t\tconsole.log(ctx.sum++);\n\n\t\t\t//喚醒 下個流程\n\t\t\tasync.Notify({\n\t\t\t\tContent:ctx,\n\t\t\t\tError:\"流程錯誤\",\n\t\t\t});\n\t\t},1000);\n\t},function(err,ctx){\n\t\tconsole.log(\"error at step 0 \" + err);\n\n\t\treturn true;\t//返回 true 使用 全局 Error 亦被調用\n\t}).Sync(function(async,ctx){\n\t\t//do something\n\n\t\t//async call\n\t\tsetTimeout(function(){\n\t\t\tconsole.log(ctx.sum++);\n\n\t\t\t//喚醒 下個流程\n\t\t\tasync.Notify({\n\t\t\t\tContent:ctx,\n\t\t\t\t//Error:\"流程錯誤\",\n\t\t\t});\n\t\t},1000);\n\t},function(err,ctx){\n\t\tconsole.log(\"error at step 1 \" + err);\n\t}).Sync(function(async,ctx){\n\t\t//do something\n\n\t\t//async call\n\t\tsetTimeout(function(){\n\t\t\tconsole.log(ctx.sum++);\n\n\t\t\t//喚醒 下個流程\n\t\t\tasync.Notify({\n\t\t\t\tContent:ctx,\n\t\t\t});\n\t\t},1000);\n\t})//執行流程\n\t.Do({\n\t\t//成功時 被調用\n\t\tOk:function(ctx){\n\t\t\tconsole.log(async.Status() + \" sum=\"+ ctx.sum);\n\t\t},\n\t\t//失敗時 被調用\n\t\tError:function(err,ctx){\n\t\t\tconsole.log(async.Status() + \" err=\" + err);\n\t\t},\n\t\t//在 Ok Error 之後被調用\n\t\tEnd:function(err,ctx){\n\t\t\tconsole.log(\"End \" + async.Status() + \" err=\"+ err);\n\t\t},\n\t});\n});\u003c/pre\u003e"