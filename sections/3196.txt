var __v="\n\u003cpre class='prettyprint linenums'\u003e\n//返回notify8接口\nLPDIRECTSOUNDNOTIFY sound_notify8;\nif(S_OK != sound_buffer-\u0026gt;QueryInterface(IID_IDirectSoundNotify8,(LPVOID*)\u0026amp;sound_notify8))\n{\n\tthrow dark::debug::wexception(L\"獲取次緩衝區notify8接口失敗\");\n}\n//定義一個關心的事件\nhEvent=CreateEvent(NULL,FALSE,FALSE,NULL);\nif(!hEvent)\n{\n\tthrow dark::debug::wexception(L\"創建event失敗\");\n}\nDSBPOSITIONNOTIFY cPositionNotifies;\ncPositionNotifies.dwOffset\t\t=\twave_format.nAvgBytesPerSec*3;\t\t\t//位置關心的位置 此處為3秒\ncPositionNotifies.hEventNotify\t=\thEvent;\nif(DS_OK != sound_notify8-\u0026gt;SetNotificationPositions(1,\u0026amp;cPositionNotifies))\n{\n\tthrow dark::debug::wexception(L\"SetNotificationPositions失敗\");\n}\nsound_notify8-\u0026gt;Release();\n\n//啟動wait線程\nAfxBeginThread(waitThread,this);\n\n\n//wait線程\nUINT AFX_CDECL CDirectxTestDlg::waitThread(LPVOID lParam)\n{\n\tCDirectxTestDlg* lp=(CDirectxTestDlg*)lParam;\n\twhile(true)\n\t{\n\t\tWaitForSingleObject(lp-\u0026gt;hEvent,INFINITE);\n\t\tAfxMessageBox(L\"到達播放位置\");\n\t}\n\treturn 0;\n}\u003c/pre\u003e"