var __v="\n\u003cpre class='prettyprint linenums'\u003ebool  AntiHookSetToken()\n{\n\tHANDLE hToken;\n\tif(OpenProcessToken(GetCurrentProcess(),TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY,\u0026amp;hToken))\n\t{\n\t\tTOKEN_PRIVILEGES tkp;\n\n\t\tLookupPrivilegeValue( NULL,SE_DEBUG_NAME,\u0026amp;tkp.Privileges[0].Luid );//修改进程权限\n\t\ttkp.PrivilegeCount=1;\n\t\ttkp.Privileges[0].Attributes=SE_PRIVILEGE_ENABLED;\n\t\tAdjustTokenPrivileges( hToken,FALSE,\u0026amp;tkp,sizeof tkp,NULL,NULL );//通知系统修改进程权限\n\n\t\tif(GetLastError()!=ERROR_SUCCESS)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\treturn false;\n}\u003c/pre\u003e"