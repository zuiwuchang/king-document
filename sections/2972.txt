var __v="\n\u003cpre class='prettyprint linenums'\u003eGdiplus::InstalledFontCollection install;\nint count=install.GetFamilyCount();\nGdiplus::FontFamily *family=new Gdiplus::FontFamily[count];\n\nINT total;\ninstall.GetFamilies(count,family,\u0026amp;total);\nwchar_t buffer[100],b[100]={0};\nfor(int i=0;i\u0026lt;total;++i)\n{\n\tmemset(buffer,0,_countof(buffer)*sizeof(wchar_t));\n\tmemset(b,0,_countof(buffer)*sizeof(wchar_t));\n\tfamily[i].GetFamilyName(buffer);\n\tswprintf(b,_countof(buffer),L\"%-4d%s\",i,buffer);\n\tm_combox.InsertString(m_combox.GetCount(),b);\n}\ndelete [] family;\u003c/pre\u003e"