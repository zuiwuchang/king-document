var __v="\n\u003cpre class='prettyprint linenums'\u003epackage main\n\nimport (\n\t\"fmt\"\n\t\"golang.org/x/net/websocket\"\n\t\"log\"\n\t\"net/http\"\n)\n\nfunc echoHandler(ws *websocket.Conn) {\n\tvar e error\n\tvar msg string\n\tfor {\n\t\t//接收消息\n\t\tif e = websocket.Message.Receive(ws, \u0026amp;msg); e != nil {\n\t\t\tlog.Println(e)\n\t\t\tbreak\n\t\t}\n\t\tfmt.Println(\"Receive:\", msg)\n\n\t\t//發送消息\n\t\tmsg = \"s-\" + msg\n\t\tif e = websocket.Message.Send(ws, msg); e != nil {\n\t\t\tlog.Println(e)\n\t\t\tbreak\n\t\t}\n\t}\n\t//關閉 連接\n\tws.Close()\n}\n\nfunc main() {\n\taddr := \":8080\"\n\thttp.Handle(\"/echo\", websocket.Handler(echoHandler))\n\tfmt.Println(\"work at \", addr)\n\te := http.ListenAndServe(addr, nil)\n\tif e != nil {\n\t\tlog.Fatalln(e)\n\t}\n}\n\u003c/pre\u003e"