var __v="\n\u003cpre class='prettyprint linenums'\u003eID2D1Factory* d2d_factory_ptr\t=\tNULL;\nID2D1HwndRenderTarget* d2d_target_ptr\t=\tNULL;\nID2D1SolidColorBrush* d2d_brush_ptr = NULL;\nint APIENTRY _tWinMain(HINSTANCE hInstance,\n                     HINSTANCE hPrevInstance,\n                     LPTSTR    lpCmdLine,\n                     int       nCmdShow)\n{\n\t...\n\t// 执行应用程序初始化:\n\tif (!InitInstance (hInstance, nCmdShow))\n\t{\n\t\td2d_factory_ptr \u0026amp;\u0026amp; d2d_factory_ptr-\u0026gt;Release();\n\t\td2d_target_ptr \u0026amp;\u0026amp; d2d_target_ptr-\u0026gt;Release();\n\t\td2d_brush_ptr \u0026amp;\u0026amp; d2d_brush_ptr-\u0026gt;Release();\n\t\treturn FALSE;\n\t}\n\n\t...    \n\td2d_brush_ptr-\u0026gt;Release();\n\td2d_target_ptr-\u0026gt;Release();\n\td2d_factory_ptr-\u0026gt;Release();\n\n\treturn (int) msg.wParam;\n}\nBOOL InitInstance(HINSTANCE hInstance, int nCmdShow)\n{\n\t...\n\t//創建設備工廠\n   HRESULT\thr = D2D1CreateFactory(D2D1_FACTORY_TYPE_SINGLE_THREADED,\u0026amp;d2d_factory_ptr);\n   if(hr\t!=\tS_OK)\n   {\n\t   return FALSE;\n\t\n   }\n   RECT rect;\n   GetWindowRect(hWnd,\u0026amp;rect);\n\t//創建繪製目標\n   hr\t=\td2d_factory_ptr-\u0026gt;CreateHwndRenderTarget(D2D1::RenderTargetProperties()\n\t   ,D2D1::HwndRenderTargetProperties(hWnd\n\t\t\t,D2D1::SizeU(rect.right-rect.left,rect.bottom-rect.top)\n\t\t\t)\n\t\t,\u0026amp;d2d_target_ptr\n\t\t);\n   if(hr != S_OK)\n   {\n\t   return FALSE;\n   }\n\t//創建畫刷\n   hr\t=\td2d_target_ptr-\u0026gt;CreateSolidColorBrush(D2D1::ColorF(D2D1::ColorF::Red)\n\t   ,\u0026amp;d2d_brush_ptr\n\t   );\n   if(hr != S_OK)\n   {\n\t   return FALSE;\n   }\n\tShowWindow(hWnd, nCmdShow);\n   UpdateWindow(hWnd);\t//產生WM_PAIN\n}\n\n\t...\ncase WM_PAINT:\n\t\t\n\td2d_target_ptr-\u0026gt;BeginDraw();\n\td2d_target_ptr-\u0026gt;Clear(D2D1::ColorF(D2D1::ColorF::DarkBlue));\t//以指定顏色 清除背景\n\t\td2d_target_ptr-\u0026gt;DrawRectangle(D2D1::RectF(100.0f,100.0f,500.0f,500.0f)\n\t\t\t,d2d_brush_ptr\n\t\t\t);\n\td2d_target_ptr-\u0026gt;EndDraw();\t//成功繪製返回 S_OK\n\tbreak;\n\t...\u003c/pre\u003e"