var __v="\n\u003cpre class='prettyprint linenums'\u003e\ts := grpc.NewServer(\n\t\t//為服務 設置 攔截器\n\t\tgrpc.UnaryInterceptor(\n\t\t\tfunc(ctx context.Context,\n\t\t\t\treq interface{},\n\t\t\t\tinfo *grpc.UnaryServerInfo,\n\t\t\t\thandler grpc.UnaryHandler) (resp interface{}, err error) {\n\n\t\t\t\t// 解析metada中的信息并验证\n\t\t\t\tmd, ok := metadata.FromIncomingContext(ctx)\n\t\t\t\tif !ok {\n\t\t\t\t\treturn nil, grpc.Errorf(codes.Unauthenticated, \"unknow token\")\n\t\t\t\t}\n\t\t\t\tif _, ok := md[\"appkey\"]; !ok {\n\t\t\t\t\treturn nil, grpc.Errorf(codes.Unauthenticated, \"unknow token\")\n\t\t\t\t}\n\n\t\t\t\t//設置 新的 token 值\n\t\t\t\tmd = metadata.Pairs(\"lv\", \"10\")\n\t\t\t\tctx = metadata.NewIncomingContext(ctx, md)\n\t\t\t\t\n\t\t\t\t//路由\n\t\t\t\treturn handler(ctx, req)\n\t\t\t},\n\t\t),\n\t)\u003c/pre\u003e"