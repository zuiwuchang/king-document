var __v="\n\u003cpre class='prettyprint linenums'\u003e//獲取資源句柄\nHINSTANCE\thInstance\t=\tAfxGetResourceHandle();\nHRSRC\t\thRsrc\t\t=\tFindResource(hInstance,MAKEINTRESOURCE(IDR_JPEG1),L\"JPEG\");\nif(hRsrc)\n{\n\t//將資源載入內存\n\tHGLOBAL hGlobal\t=\tLoadResource(hInstance,hRsrc);\n\tif(hGlobal)\n\t{\n\t\t//返回資源大小\n\t\tDWORD len\t=\tSizeofResource(hInstance,hRsrc);\n\n\t\t//創建流對象\n\t\tHGLOBAL\thMem\t=\tGlobalAlloc(GMEM_FIXED,len);\n\t\tBYTE*\tpMem\t=\t(BYTE*)GlobalLock(hMem);\n\t\tmemcpy(pMem,hGlobal,len);\n\t\tIStream*\tpStm;\n\t\tCreateStreamOnHGlobal(hMem,FALSE,\u0026amp;pStm);\n\n\t\tGdiplus::Graphics graphics(m_hWnd);\n\n\t\tGdiplus::Image image(pStm);\n\n\t\tgraphics.DrawImage(\u0026amp;image,Gdiplus::Rect(10,10,100,100));\n\n\t\t//釋放內存\n\t\tGlobalUnlock(hMem);\n\t\tpStm-\u0026gt;Release();\n\t\tGlobalFree(hMem);\n\n\t}\n\t//卸載資源\n\tFreeResource(hGlobal);\n}\u003c/pre\u003e"