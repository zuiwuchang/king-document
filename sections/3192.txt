var __v="\n\u003cpre class='prettyprint linenums'\u003e//讀取要播放wav屬性\ndark::sound::WaveFormat wave(L\"爱是没余地.wav\");\n\n//設置聲音屬性\nWAVEFORMATEX wave_format;\nmemset(\u0026amp;wave_format,0,sizeof(WAVEFORMATEX));\nwave_format.wFormatTag\t\t\t=\tWAVE_FORMAT_PCM;\nwave_format.nChannels\t\t\t=\twave.wave_format.nChannels;\t\t\t\t//單聲道\nwave_format.nSamplesPerSec\t\t=\twave.wave_format.nSamplesPerSec;\t\t//採樣率為44.1Hz\t22050(22.05Hz)\nwave_format.wBitsPerSample\t\t=\twave.wave_format.wBitsPerSample;\t\t//採樣位數\n//採樣塊對齊大小\nwave_format.nBlockAlign\t\t\t=\t(wave_format.wBitsPerSample/8)*wave_format.nChannels;\n//計算平均每秒採樣字節數\nwave_format.nAvgBytesPerSec\t\t=\twave_format.nSamplesPerSec*wave_format.nBlockAlign;\n\n//設置緩衝區屬性\nDSBUFFERDESC dsbufferdesc;\nmemset(\u0026amp;dsbufferdesc,0,sizeof(DSBUFFERDESC));\ndsbufferdesc.dwSize\t\t\t=\tsizeof(DSBUFFERDESC);\ndsbufferdesc.dwFlags\t\t=\tDSBCAPS_CTRLPAN | DSBCAPS_CTRLVOLUME | DSBCAPS_CTRLPOSITIONNOTIFY | DSBCAPS_GLOBALFOCUS | DSBCAPS_GETCURRENTPOSITION2 ;\ndsbufferdesc.dwBufferBytes\t=\twave.wave_format.data_size;\ndsbufferdesc.lpwfxFormat\t=\t\u0026amp;wave_format;\n\n//創建次緩衝區\nif(DS_OK != device-\u0026gt;CreateSoundBuffer(\u0026amp;dsbufferdesc,\u0026amp;sound_buffer,0))\n{\n\tthrow dark::debug::wexception(L\"創建次緩衝區失敗\");\n}\n\n//由次緩衝區返回緩衝區接口對象 IDirectSoundBuffer8接口 \n//LPDIRECTSOUNDBUFFER8 sound_buffer8;\nif(S_OK != sound_buffer-\u0026gt;QueryInterface(IID_IDirectSoundBuffer8,(LPVOID*)\u0026amp;sound_buffer8))\n{\n\tthrow dark::debug::wexception(L\"獲取次緩衝區接口失敗\");\n}\u003c/pre\u003e"