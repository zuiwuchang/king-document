var __v="\n\u003cpre class='prettyprint linenums'\u003e//声明SSDT结构\ntypedef struct _ServiceDescriptorTable \n{\n   PVOID ServiceTableBase;\n   PVOID ServiceCounterTable;\n   unsigned int NumberOfServices;\n   PVOID ParamTableBase;\n}ServiceDescriptorTable,*LPServiceDescriptorTable;\n\nextern \"C\" LPServiceDescriptorTable KeServiceDescriptorTable;\n\n#pragma INIT_MEMORY\nULONG GetCurFunctionAddr(ULONG index)\n{\n\tULONG function_addr=0;\n\n\tPLONG base=(PLONG)(KeServiceDescriptorTable-\u0026gt;ServiceTableBase);\n\t\n\tfunction_addr=base[index];\n\treturn function_addr;\n}\u003c/pre\u003e"