var __v="\n\u003cpre class='prettyprint linenums'\u003e#include\u0026lt;shlobj.h\u0026gt;\nint _tmain(int argc, _TCHAR* argv[])\n{\n\tstd::wcout.imbue(std::locale(\"chs\"));\n\n\twchar_t name[MAX_PATH],path[MAX_PATH]={0};\n\t\n\t//定義顯示結構\n\tBROWSEINFO bi; \n\tbi.hwndOwner = NULL; \n\tbi.pidlRoot = NULL; \n\tbi.pszDisplayName = name;\t//緩衝區地址用以 保存選擇的 文件夾名(不包含全路徑)\n\tbi.lpszTitle =L\"文件夹选择\";\t//左上角標題\n\tbi.ulFlags = BIF_RETURNONLYFSDIRS; \n\tbi.lpfn = NULL; \n\tbi.lParam = 0; \n\tbi.iImage = 0; \n\n\tITEMIDLIST *pidl; \n\t //显示\n\tpidl = SHBrowseForFolder( \u0026amp;bi );\n\t\n\tif(pidl) \n\t{\n\t\tstd::wcout\u0026lt;\u0026lt;L\"文件夾:\"\u0026lt;\u0026lt;name\u0026lt;\u0026lt;std::endl;\n\t\t//獲取全路徑\n\t\tif (SHGetPathFromIDList(pidl,path ))\n\t\t{\t\n\t\t\tstd::wcout\u0026lt;\u0026lt;L\"全路徑:\"\u0026lt;\u0026lt;path\u0026lt;\u0026lt;std::endl;\n\t\t}\n\t}\n\n\tsystem(\"pause\");\n\treturn 0;\n}\u003c/pre\u003e"