var __v="\u003cpre class=\"k-pre\"\u003e\u003cstrong\u003estep 1 定義一個派生自QObject 的class作為 Channel\u003c/strong\u003e\n\u003cpre class='prettyprint linenums'\u003e#ifndef MYCHANNEL_H\n#define MYCHANNEL_H\n\n#include \u0026lt;QObject\u0026gt;\n\nclass MyChannel : public QObject\n{\n    Q_OBJECT\n    Q_PROPERTY(QString text MEMBER _text NOTIFY textChanged)\npublic:\n    explicit MyChannel(QObject *parent = 0);\n\n\n\nprivate:\n    QString _text = \"val test\";\n\nsignals:\n    void textChanged(const QString \u0026amp;text);\npublic slots:\n    void Show(const QString\u0026amp; str);\n    void onTextChanged(const QString\u0026amp; text);\n};\n\n#endif // MYCHANNEL_H\n\n\n#include \"mychannel.h\"\n#include \u0026lt;QMessageBox\u0026gt;\nMyChannel::MyChannel(QObject *parent) : QObject(parent)\n{\n    connect(this,\u0026amp;MyChannel::textChanged,this,\u0026amp;MyChannel::onTextChanged);\n}\nvoid MyChannel::onTextChanged(const QString\u0026amp; text)\n{\n    QMessageBox::information(nullptr,\"value change\",text);\n}\nvoid MyChannel::Show(const QString\u0026amp; str)\n{\n    QMessageBox::information(nullptr,\"from js call\",str);\n}\u003c/pre\u003e\n\n\u003cstrong\u003estep 2 將 Channel 註冊到 QWebEngineView 的Page上\u003c/strong\u003e\n\u003cpre class='prettyprint linenums'\u003e_view = new QWebEngineView(this);\nQWebEnginePage* page = _view-\u0026gt;page();\n\nQWebChannel *channel = new QWebChannel(this);\nchannel-\u0026gt;registerObject(QStringLiteral(\"mychannel\"), new MyChannel(this));\npage-\u0026gt;setWebChannel(channel);\n\npage-\u0026gt;load(QUrl(QStringLiteral(\"qrc:///view/index.html\")));\n\u003c/pre\u003e\n\n\u003cstrong\u003estep 3 在html中引入js qwebchannel.js\nqwebchannel.js 有qt 提供 在 \nQt5.7.0/Examples/Qt-5.7/webenginewidgets/markdowneditor/resources 中\u003c/strong\u003e\n\u003cpre class='prettyprint linenums'\u003e\u0026lt;script type=\"text/javascript\" src=\"qrc:///view/qwebchannel.js\"\u0026lt;\u0026gt;/script\u0026gt;\u003c/pre\u003e\n\n\u003cstrong\u003estep 4 在html中引 創建 QWebChannel 對象 獲取channel對象\u003c/strong\u003e\n\u003cpre class='prettyprint linenums'\u003e\u0026lt;button onclick='on_click();'\u0026gt;call c++\u0026lt;/button\u0026gt;\n\n\u0026lt;script type=\"text/javascript\"\u0026gt;\nfunction get_name(){\n\treturn \"index view\";\n}\n\nnew QWebChannel(qt.webChannelTransport, function(channel) {\n        window.mychannel = channel.objects.mychannel;\n      });\nfunction on_click(){\n\tif(window.mychannel){\n\t\tvar text = window.mychannel.text;\n\t\talert(text);\n\t\twindow.mychannel.text = \"val change\";\n\t\twindow.mychannel.Show(\"test msg\");\n\t}\n}\n\u0026lt;/script\u0026gt;\u003c/pre\u003e\n\u003c/pre\u003e"