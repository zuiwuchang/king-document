var __v="\n\u003cpre class='prettyprint linenums'\u003e//.h\nclass CMFCTestDlg : public CDialogEx\n{\n...\n\tCListCtrl m_listctrl;\n\tCImageList images;\n...\n}\n\n//.cpp\nBOOL CMFCTestDlg::OnInitDialog()\n{\n...\n\tSHFILEINFO info;\n\t\n\t//返回系统图标列表\n\tHIMAGELIST hImageList\t=\t(HIMAGELIST )SHGetFileInfo(L\"\"\n\t\t,0\n\t\t,\u0026amp;info\n\t\t,sizeof(info)\n\t\t,SHGFI_SYSICONINDEX\n\t\t);\n\timages.Attach(hImageList);\n\t\n\tm_listctrl.SetImageList(\u0026amp;images,LVSIL_NORMAL);\n\t\n\tCString str;\n\tfor(int i=0;i\u0026lt;images.GetImageCount();++i)\n\t{\n\t\tstr.Format(L\"%d\",i);\n\t\tm_listctrl.InsertItem(i,str,i);\n\t}\n...\n}    \n\nvoid CMFCTestDlg::OnBnClickedButton1()\n{\n\tCString path\t=\tL\"c:\\\\a.exe\";\n\tDWORD dwFileAttributes\t=\tGetFileAttributes(path);\n\t//失败 可能是文件不存在\n\tif(INVALID_FILE_ATTRIBUTES\t==\tdwFileAttributes)\n\t{\n\t\tdwFileAttributes\t|=\tFILE_ATTRIBUTE_NORMAL;\n\t}\n\n\tSHFILEINFO info;\n\tSHGetFileInfo(L\"\"\n\t\t,dwFileAttributes\n\t\t,\u0026amp;info\n\t\t,sizeof(info)\n\t\t,SHGFI_SYSICONINDEX | SHGFI_USEFILEATTRIBUTES\n\t\t);\n\t\n\tpath.Format(L\"%d\",info.iIcon);\n\tm_listctrl.InsertItem(m_listctrl.GetItemCount(),path,info.iIcon);\n}\u003c/pre\u003e"