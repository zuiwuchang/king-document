var __v="\u003cpre class=\"k-pre\"\u003e先將要釋放的文件 作為資源導入\n\u003c/pre\u003e\n\u003cpre class='prettyprint linenums'\u003e//定位資源\nHRSRC hRsc=FindResource(NULL\t\t\t//資源所在模塊句柄 本模塊傳入NULL\n\t,MAKEINTRESOURCE(IDR_MYBINARY1)\t\t//資源名 宏MAKEINTRESOURCE將ID轉為對應名稱\n\t,L\"MyBinary\");\t\t\t\t\t\t//資源類型\nif(hRsc)\n{\n\t//載入資源到內存\n\tHGLOBAL hGlobal=LoadResource(NULL,hRsc);\n\tif(hGlobal)\n\t{\n\t\t//讀取資源大小\n\t\tDWORD dwSize=SizeofResource(NULL,hRsc);\n\t\t\n\t\t//寫入文件\n\t\tHANDLE hFile=CreateFile(L\"a.exe\",GENERIC_WRITE,FILE_SHARE_READ,0,CREATE_ALWAYS,FILE_ATTRIBUTE_NORMAL,NULL);\n\t\tDWORD dwWrite;\n\t\tWriteFile(hFile,hGlobal,dwSize,\u0026amp;dwWrite,NULL);\n\t\tCloseHandle(hFile);\n\n\t\t//卸載資源\n\t\tFreeResource(hGlobal);\n\t}\n}\u003c/pre\u003e"