var __v="\u003cpre class=\"k-pre\"\u003e創建的設備對象IDirectSound8接口 的CreateSoundBuffer 創建緩衝區\n//創建緩衝區 成功返回DS_OK 或者DS_NO_VIRTUALIZATION(請求的3D算法不支持立體聲 立體聲被取代)\nHRESULT CreateSoundBuffer(\n         LPCDSBUFFERDESC pcDSBufferDesc,\t\t//傳入緩衝區結構 以指示緩衝區屬性\n         LPDIRECTSOUNDBUFFER * ppDSBuffer,\t\t//返回緩衝區指針 既IDirectSoundBuffer IDirectSoundBuffer8接口\n         LPUNKNOWN pUnkOuter\t\t\t\t\t//系統保留 必須為0\n)\n\n//緩衝區結構\ntypedef struct DSBUFFERDESC {\n    DWORD dwSize;\t\t\t\t//結構大小\n    DWORD dwFlags;\t\t\t\t//標識緩衝區用途\n    DWORD dwBufferBytes;\t\t\t//緩衝區大小\t(主緩衝區必須設置為0)\n    DWORD dwReserved;\t\t\t\t//系統保留 0\n    LPWAVEFORMATEX lpwfxFormat;\t\t\t//聲音格式屬性 (主緩衝區必須設置為0) WAVEFORMATEX 或 WAVEFORMATEXTENSIBLE結構指針\n    GUID guid3DAlgorithm;\t\t\t//3D音效算法\n} DSBUFFERDESC;\n\ndwFlags取值\nDSBCAPS_CTRL3D\t\t\t具有3D音效控制 不能餘DSBCAPS_CTRLFREQUENCY聯用\nDSBCAPS_CTRLFREQUENCY\t\t緩衝區可設置採樣率\nDSBCAPS_CTRLFX\t\t\t緩衝區註冊特性處理(effect processing) \nDSBCAPS_CTRLPAN\t\t\t緩衝區可控制聲道\nDSBCAPS_CTRLVOLUME  \t\t緩衝區可設置音量大小\nDSBCAPS_CTRLPOSITIONNOTIFY  \t緩衝區具有播放位置通知能力  \nDSBCAPS_GETCURRENTPOSITION2\t能獲取精確的播放位置 \nDSBCAPS_GLOBALFOCUS\t\t緩衝區是全局資源 當切換到其他程序 仍然播放聲音  \t\nDSBCAPS_LOCDEFER  \t\t緩衝區可綁定為硬件或軟件內存來播放聲音\nDSBCAPS_LOCHARDWARE \t\t緩衝區必須使用硬混聲器 如果硬件不支持 CreateSoundBuffer返回失敗\nDSBCAPS_LOCSOFTWARE   \t\t緩衝區使用軟件內存或軟件混聲\nDSBCAPS_MUTE3DATMAXDISTANCE  \t超過最大可聽距離 停止播放\nDSBCAPS_PRIMARYBUFFER  \t\t說明創建的是主緩衝區 否則次緩衝區\nDSBCAPS_STATIC \t\t\t自動使用硬件內存作為緩衝區 \nDSBCAPS_STICKYFOCUS \t\t當出現切換到其他不使用DirectSound的程序時 緩衝區仍然播放 但無法正常進行其他處理\nDSBCAPS_TRUEPLAYPOSITION  \n\n\n//聲音格式屬性\ntypedef struct WAVEFORMATEX {\n    WORD wFormatTag;\t\t\t//格式類型 表示壓縮算法\n    WORD nChannels;\t\t\t//聲道數(通常1~2個)\n    DWORD nSamplesPerSec;\t\t//採樣率\n    DWORD nAvgBytesPerSec;\t\t//每秒採樣字節數\n    WORD nBlockAlign;\t\t\t//塊對齊大小\n    WORD wBitsPerSample;\t\t//採樣位數\n    WORD cbSize;\t\t\t//附加段數據大小\n} WAVEFORMATEX;\n\u003c/pre\u003e"