var __v="\n\u003cpre class='prettyprint linenums'\u003evoid MyFrame::OnTest(wxCommandEvent\u0026amp; WXUNUSED(event))\n{\n    //打開 application\n    wxAutomationObject excelObject, rangeObject;\n    if (!excelObject.GetInstance(_T(\"Excel.Application\")))\n    {\n        if (!excelObject.CreateInstance(_T(\"Excel.Application\")))\n        {\n            wxMessageBox(_(\"Could not create Excel object.\"));\n            return;\n        }\n    }\n\n    //設置可見\n    if (!excelObject.PutProperty(_T(\"Visible\"), true))\n    {\n        wxMessageBox(_(\"Could not make Excel object visible\"));\n        return;\n    }\n\n    //獲取工作薄數量\n    const wxVariant workbooksCountVariant = excelObject.GetProperty(_T(\"Workbooks.Count\"));\n    if (workbooksCountVariant.IsNull())\n    {\n        wxMessageBox(_(\"Could not get workbooks count\"));\n        return;\n    }\n    const long workbooksCount = workbooksCountVariant;\n    if (workbooksCount == 0)\n    {\n        //打開 工作薄\n        //const wxVariant workbook = excelObject.CallMethod(_T(\"Workbooks.open\"), _T(\"c:/1.xls\"));\n        //新建工作薄\n        const wxVariant workbook = excelObject.CallMethod(_T(\"Workbooks.Add\"));\n        if (workbook.IsNull())\n        {\n            wxMessageBox(_(\"Could not create new Workbook\"));\n            return;\n        }\n\n    }\n    //設置活動項\n    if (!excelObject.PutProperty(_T(\"ActiveCell.Value\"),_T(\"wxWidgets automation test!\")))\n    {\n        wxMessageBox(_(\"Could not set active cell value.\"));\n        return;\n    }\n\n    //設置指定項 此處為 第3行第2列\n    wxVariant params[2];\n    params[0]=3L;\n    params[1]=2L;\n    excelObject.GetObject(rangeObject,wxT(\"cells\"),2,params);\n    rangeObject.PutProperty(_T(\"value\"),wxVariant(_T(\"草泥馬 funck excel\")));\n\n\n    wxString str = rangeObject.GetProperty(_T(\"value\")).GetString();\n    wxMessageBox(str);\n\n    //另存為\n    excelObject.CallMethod( _T(\"ActiveWorkbook.SaveAs\"),(_T(\"c:/2.xls\")));\n    //關閉excel\n    excelObject.CallMethod( _T(\"Quit\"));\n}\u003c/pre\u003e"