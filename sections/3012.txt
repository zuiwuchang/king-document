var __v="\u003cpre class=\"k-pre\"\u003e灰度圖的 原理既是 讓 R G B 分量值相等 常用 一下三種計算方式\n1 平均值 R=G=B=(R+G+B)/3\n2 最大值 R=G=B=max(R,G,B)\n3 加權平均值 R=G=B=WrR+WgG+WbB\t//一般為 R=G=B=0.299R+0.587G+0.114B\n\n由加權平均值 可得變換公式為\n0.299 0.299 0.299 0 0\n0.587 0.587 0.587 0 0\n0.114 0.114 0.114 0 0\n0 0 0 1 0\n0 0 0 0 1\n\u003c/pre\u003e\n\u003cpre class='prettyprint linenums'\u003eGdiplus::Image image(L\"psb.jpg\");\n\nGdiplus::Graphics graphics(m_hWnd);\n\n//設置分量\nGdiplus::ColorMatrix color_matrix ={0.299f,0.299f,0.299f,0,0\n\t,0.587f,0.587f,0.587f,0,0\n\t,0.114f,0.114f,0.114f,0,0\n\t,0,0,0,1,0\n\t,0,0,0,0,1\n};\nGdiplus::ImageAttributes image_attr;\nimage_attr.SetColorMatrix(\u0026amp;color_matrix);\n\n//傳入ImageAttributes繪圖\ngraphics.DrawImage(\u0026amp;image\n\t,Gdiplus::Rect(10,10,300,300)\n\t,0,0,image.GetWidth(),image.GetHeight()\n\t,Gdiplus::UnitPixel\n\t,\u0026amp;image_attr\n\t);\u003c/pre\u003e"