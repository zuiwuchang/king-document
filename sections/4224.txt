var __v="\n\u003cpre class='prettyprint linenums'\u003e#include \u0026lt;lame/lame.h\u0026gt;\n\n#include \u0026lt;cstdio\u0026gt;\n#include \u0026lt;cstdlib\u0026gt;\n\n#define PCM_BUF_SIZE 1024\n#define MP3_SIZE 8192\nint main()\n{\n    //創建 lame\n    lame_t lame = lame_init();\n    lame_set_in_samplerate(lame, 8000);\t//設置輸入 採樣率\n    lame_set_num_channels(lame, 1);\t\t//設置輸入 通道數\n    lame_set_mode(lame, MONO);\n    lame_init_params(lame);\t//初始化 lame\n\n    //打開檔案\n    FILE *fPcm = fopen(\"100.wav\", \"rb\");\n    FILE *fMp3 = fopen(\"100.mp3\", \"wb\");\n\n    //創建緩衝區\n    short int pcmBuffer16[PCM_BUF_SIZE];\n    unsigned char pcmBuffer[PCM_BUF_SIZE];\n    unsigned char mp3Buffer[MP3_SIZE];\n    int nWrite,nRead,i;\n\n    do\n    {\n        //讀取 pcm8 數據\n        nRead = fread(pcmBuffer, sizeof(char), PCM_BUF_SIZE, fPcm);\n        for (i = 0; i \u0026lt; nRead; i++)\n        {\n            //將 pcm 轉到 pcm16\n            pcmBuffer16[i] = (short int)(pcmBuffer[i] - 0x80) \u0026lt;\u0026lt; 8;\n        }\n\n        //轉碼\n        if (nRead == 0)\n        {\n            nWrite = lame_encode_flush(lame, mp3Buffer, MP3_SIZE);\n        }\n        else\n        {\n            nWrite = lame_encode_buffer(lame,\n                                        pcmBuffer16, NULL,//單聲道 所以爲右聲道傳入 null\n                                        nRead,\n                                        mp3Buffer, MP3_SIZE);\n        }\n\n        //將轉碼 數據保存\n        fwrite(mp3Buffer, sizeof(char), nWrite, fMp3);\n    }\n    while(nRead \u0026gt; 0);\n\n    //釋放資源\n    lame_close(lame);\n    fclose(fMp3);\n    fclose(fPcm);\n    return 0;\n}\n\u003c/pre\u003e"